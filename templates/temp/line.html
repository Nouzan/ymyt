<html>
    <script src="https://unpkg.com/lightweight-charts/dist/lightweight-charts.standalone.production.js"></script>
    <body>
    </body>
    <script>
        function load(name) {
            let xhr = new XMLHttpRequest(),
                okStatus = document.location.protocol === "file:" ? 0 : 200;
            xhr.open('GET', name, false);
            xhr.overrideMimeType("text/html;charset=utf-8");//默认为utf-8
            xhr.send(null);
            return xhr.status === okStatus ? xhr.responseText : null;
        }

        function update(series, chart) {
            return function handle() {
                let text = load("btc_close_value.json");
                console.log(text);
                const datas = JSON.parse(text);
                series.setData(datas);
                chart.timeScale().fitContent();
            }
        }
    
        const chart = LightweightCharts.createChart(document.body, {
            width: 1000, 
            height: 580, 
            localization: {
                locale: 'ja-JP',
            },
        });
        chart.applyOptions({
            priceScale: {
                position: 'right',
                mode: 0,
                autoScale: true,
                invertScale: false,
                alignLabels: false,
                borderVisible: false,
                scaleMargins: {
                    top: 0.2,
                    bottom: 0.1,
                },
            },
            timeScale: {
                rightOffset: 0,
                barSpacing: 3,
                fixLeftEdge: true,
                lockVisibleTimeRangeOnResize: true,
                rightBarStaysOnScroll: true,
                borderVisible: false,
                borderColor: '#fff000',
                visible: true,
                timeVisible: true,
                secondsVisible: false,
            },
        });
        const series = chart.addAreaSeries();
        series.applyOptions({
            priceFormat: {
                type: 'price',
                precision: 6,
                minMove: 0.000001,
            },
        })

        const datas = [
            { time: "2020-01-01", value: 100 },
            { time: "2020-01-02", value: 120 },
            { time: "2020-01-03", value: 130 },
        ];
        series.setData(datas);
        chart.timeScale().fitContent();

        // update(series, chart)();

        // setInterval(update(series, chart), 1 * 1000);
    </script>
</html>